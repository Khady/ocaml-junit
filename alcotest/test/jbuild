(jbuild_version 1)

(executable
 ((name alcotest_report)
  (modules (alcotest_report))
  (libraries (junit junit_alcotest))
  (flags (:standard -safe-string -short-paths))
  ))

(rule
 ((targets (alcotest_report.xml))
  (deps (alcotest_report.exe))
  (action (setenv REPORT_PATH ${@} (run ${<})))
  ))

(alias
 ((name runtest)
  (package junit_alcotest)
  (action (diff ${path:alcotest_report.expected} ${path:alcotest_report.xml}))
  (deps (alcotest_report.exe))
  ))
